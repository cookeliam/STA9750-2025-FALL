---
title: "Mini-Project #01: Exploring the Most Popular Programming on Netflix"
author: Liam Cooke
date: "03 October 2025"
format: 
  html:
    code-fold: true
    toc: true
    toc-depth: 3
    self-contained: true
editor: visual
---

## Data Acquisition, Import, and Preparation
For this project, I dealt with two separate data files taken from Netflix’s TuDum Top 10: Global Top 10 and Country-wide Top 10. I loaded the datasets with read_tsv and cleaned values with "N/A" by converting them into NA where appropriate.
```{r}
#| output: false

#Task 1
if(!dir.exists(file.path("data", "mp01"))){
  dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.csv")

if(!file.exists(GLOBAL_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv", 
                destfile=GLOBAL_TOP_10_FILENAME)
}

COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.csv")


if(!file.exists(COUNTRY_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv", 
                destfile=COUNTRY_TOP_10_FILENAME)
}

if(!require("tidyverse")) install.packages("tidyverse")
library(readr)
library(dplyr)

#Task 2
GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME)

GLOBAL_TOP_10 <- GLOBAL_TOP_10 |>
  mutate(season_title = if_else(season_title =="N/A", NA, season_title))
glimpse(GLOBAL_TOP_10)

#Task 3 
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = "N/A")
```

## Initial Data Exploration
I went through Exploratory Data Analysis to understand the kind of information we could find within the above datasets. Below shows a formatted, near-publication-ready table to view the current Global Top 10. Further below details important exploratory questions and answers to help with my research.
```{r}
library(stringr)
library(DT)
format_titles <- function(df){
    colnames(df) <- str_replace_all(colnames(df), "_", " ") |> str_to_title()
    df
}

GLOBAL_TOP_10 |> 
    mutate(`runtime_(minutes)` = round(60 * runtime)) |>
    select(-season_title, 
           -runtime) |>
    format_titles() |>
    head(n=20) |>
    datatable(options=list(searching=FALSE, info=FALSE)) |>
    formatRound(c('Weekly Hours Viewed', 'Weekly Views'))
```

### Exploratory Questions


```{r, echo=FALSE}
num_countries <- COUNTRY_TOP_10 |>
  distinct(country_name)|>
  nrow()
```
#### 1. How many different countries does Netflix operate in?
Netflix operates in `r num_countries` different countries.
```{r}
num_countries <- COUNTRY_TOP_10 |>
  distinct(country_name)|>
  nrow()
```


#### 2. Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?
The top non-English film was All Quiet on the Western Front with 276 weeks spent in the global top 10.
```{r, results='show'}
top_non_english_film <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  group_by(show_title) |>
  summarize(total_number_weeks=sum(cumulative_weeks_in_top_10, na.rm=TRUE)) |>
  ungroup()|>
  arrange(desc(total_number_weeks)) |>
  slice_head(n=1)

top_non_english_film |>
  rename(
    `Show Title` = show_title,
    `Total Weeks in Top 10` = total_number_weeks
  ) |>
  datatable(
    options = list(
      dom = 't',
      paging = FALSE,
      searching = FALSE
    ),
    caption = "Top Non-English Film in the Global Top 10"
  )
```

#### 3. What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?
Pushpa 2: The Rule (Reloaded Version) is the longest film to have ever appeared in the global top 10 with a runtime of 224 minutes.
```{r}
longest_film <- GLOBAL_TOP_10 |>
  filter(str_detect(category, "Film")) |>
  drop_na(runtime) |>
  mutate(runtime_min=round(runtime * 60)) |>
  arrange(desc(runtime_min)) |>
  slice_head(n=1)

longest_film |>
  select(
    `Show Title` = show_title,
    Category = category,
    `Runtime (Minutes)` = runtime_min
  ) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Longest Film in the Global Top 10"
  )
```

#### 4. For each of the four categories, what program has the most total hours of global viewership?

```{r}
most_viewed_by_category <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarize(total_hours = sum(weekly_hours_viewed, na.rm=TRUE), .groups ="drop") |>
  arrange(category, desc(total_hours)) |>
  group_by(category)|>
  slice_head(n=1)

most_viewed_by_category |>
  select(
    Category = category,
    `Show Title` = show_title,
    `Total Hours Viewed` = total_hours
  ) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Most Viewed Program by Category (Total Global Hours)"
  ) |>
  formatRound("Total Hours Viewed", 0)
```


#### 5. Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?
The TV show Money Heist had the longest run for 127 weeks in Pakistan.
```{r}
longest_tv_run <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "TV"))|>
  group_by(show_title, country_name)|>
  summarize(total_weeks=max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups ="drop")|>
  arrange(desc(total_weeks))|>
  slice_head(n=1)

longest_tv_run |>
  select(
    `Show Title` = show_title,
    Country = country_name,
    `Total Weeks in Top 10` = total_weeks
  ) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Longest TV Show Run in a Country's Top 10"
  ) |>
  formatRound("Total Weeks in Top 10", 0)
```


#### 6. Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?
Netflix ceased operations in Russia with its last week of service being around February 27th, 2022.
```{r}
ceased_service_country <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  filter((max(week) - min(week)) < (200 * 7)) |>
  ungroup()

country_ceased_service <- unique(ceased_service_country$country_name)
week_ceased_service <- max(ceased_service_country$week)

data.frame(
  Country = country_ceased_service,
  `Last Week of Service` = week_ceased_service,
  check.names = FALSE
) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Country Where Netflix Ceased Service"
  )
```

#### 7. What is the total viewership of the TV show Squid Game?
The total viewership is 5,048,300,000 hours.
```{r}
squid_game_total_hours <- GLOBAL_TOP_10 |>
  filter(show_title == "Squid Game") |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups="drop")

squid_game_total_hours |>
  mutate(`Show Title` = "Squid Game") |>
  select(`Show Title`, `Total Hours Viewed` = total_hours) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Total Global Hours Viewed for Squid Game"
  ) |>
  formatRound("Total Hours Viewed", 0)
```

#### 8. The movie Red Notice has a runtime of 1 hour and 58 minutes. Approximately how many views did it receive in 2021?
The movie Red Notice recived 201,732,203 views in 2021.
```{r}
red_notice_2021_hours <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice", year(week) == 2021) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups="drop") |>
  pull(total_hours)

runtime_hours_red_notice <- 118 / 60 
red_notice_2021_views_approx <- red_notice_2021_hours / runtime_hours_red_notice

red_notice_summary <- tibble(
  Show = "Red Notice",
  Year = 2021,
  Total_Hours_Viewed = red_notice_2021_hours,
  Approx_Views = round(red_notice_2021_views_approx, 0)
)

colnames(red_notice_summary) <- str_replace_all(colnames(red_notice_summary), "_", " ") |> str_to_title()

red_notice_summary |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "Red Notice Estimated Global Hours Viewed and Views"
  ) |>
  formatRound(c("Total Hours Viewed", "Approx Views"), 0)
```

#### 9. How many Films reached Number 1 in the US but did not originally debut there?
45 films reached Number 1 in the US but did not originally debut there. The most recent film to first appear in the top 10 but not Number 1 is Unknown Number: The High School Catfish.
```{r}
us_films_top_reached_not_1 <- COUNTRY_TOP_10 |>
  filter(country_name == "United States",
         str_detect(category, "^Films")) |>
  group_by(show_title) |>
  summarise(
    first_week = min(week, na.rm = TRUE),
    first_week_rank = weekly_rank[which.min(week)],
    min_rank = min(weekly_rank, na.rm = TRUE),
    min_rank_week = min(week[weekly_rank == min_rank], na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(first_week_rank != min_rank, min_rank == 1) |>
  arrange(desc(min_rank_week))

us_films_top_reached_not_1 |>
  transmute(
    Title = show_title,
    `Debut Week` = format(first_week, "%Y-%m-%d"),
    `Debut Rank` = as.integer(first_week_rank),
    `Reached #1 Week` = format(min_rank_week, "%Y-%m-%d")
  ) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "US Films That Reached #1 After Debuting Below #1"
  ) |>
  formatRound("Debut Rank", 0)
```

#### 10. Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?
Emily in Paris had hit the top 10 in the most countries in its debut week, being in the chart for 94 countries.
```{r}
countries_first_week_debut <- COUNTRY_TOP_10 |>
  filter(category %in% "TV") |>
  group_by(show_title) |>
  filter(week == min(week, na.rm = TRUE)) |>
  summarize(num_of_countries = n_distinct(country_name), .groups = "drop") |>
  arrange(desc(num_of_countries))

most_countries_top_show_debut <- countries_first_week_debut |> 
  slice_max(order_by = num_of_countries, n = 1, with_ties = TRUE)

most_countries_top_show_debut |>
  transmute(
    Title = show_title,
    `# of Countries Debuted` = num_of_countries
  ) |>
  datatable(
    options = list(dom = 't', paging = FALSE, searching = FALSE),
    caption = "TV Show(s) Debuting in the Most Countries During First Week"
  ) |>
  formatRound("# of Countries Debuted", 0)
```

## Press Releases

### Stranger Things: The Global Hit Gears Up for Its Fifth and Final Season

```{r}
# Total global hours
stranger_hours <- GLOBAL_TOP_10 |>
  filter(show_title == "Stranger Things") |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))
stranger_hours_fmt <- format(stranger_hours$total_hours, big.mark = ",", scientific = FALSE)

# Total weeks
stranger_weeks <- GLOBAL_TOP_10 |>
  filter(show_title == "Stranger Things") |>
  summarise(total_weeks = n_distinct(week))

# Number of countries
stranger_countries <- COUNTRY_TOP_10 |>
  filter(show_title == "Stranger Things") |>
  summarise(num_countries = n_distinct(country_name))
```

Netflix today announced that the fifth and final season of Stranger Things will premiere in late 2025, marking the conclusion of one of the most celebrated series in streaming history. Since its debut in 2016, Stranger Things has captivated audiences around the world, generating more than `r stranger_hours_fmt` hours of viewing time across its first four seasons and maintaining a remarkable presence in the Global Top 10 for `r stranger_weeks` weeks. The show’s appeal extends far beyond U.S. borders, with viewers in over `r stranger_countries` countries making it a consistent international success story.

What sets Stranger Things apart is its ability to combine nostalgic storytelling with groundbreaking special effects and memorable characters, keeping fans engaged season after season. Compared to other English-language blockbusters like The Witcher and Bridgerton, Stranger Things has not only sustained higher cumulative hours viewed but also enjoyed a longer and more consistent chart run, proving its staying power as a cultural phenomenon. As anticipation builds for the epic final season, Netflix looks forward to delivering a conclusion that honors the show’s legacy and rewards its passionate global fanbase.


### Netflix India Dominates With Long-Running TV and Film Hits
```{r}
india_tv <- COUNTRY_TOP_10 |>
  filter(country_name == "India", category == "TV") |>
  group_by(show_title) |>
  summarise(
    weeks_in_top10 = max(cumulative_weeks_in_top_10, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(weeks_in_top10 > 10) |>
  arrange(desc(weeks_in_top10))

# Number of long-running TV shows
num_long_tv <- nrow(india_tv)

india_film <- COUNTRY_TOP_10 |>
  filter(country_name == "India", category == "Films") |>
  group_by(show_title) |>
  summarise(
    weeks_in_top10 = max(cumulative_weeks_in_top_10, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(weeks_in_top10 > 10) |>
  arrange(desc(weeks_in_top10))

# Number of long-running films
num_long_films <- nrow(india_film)

top_tv <- india_tv$show_title[1]
top_film <- india_film$show_title[1]
```
Netflix is celebrating unprecedented engagement in India, where local favorites are enjoying long runs in the Top 10 charts. In India, Netflix has seen remarkable staying power: `r num_long_tv` TV series and `r num_long_films` films have each remained in the Top 10 for over 10 weeks. Leading the way are hits like *`r top_tv`* among TV series and *`r top_film`* among films, both of which have connected strongly with audiences across the country.  

Unlike in the United States, where global blockbusters dominate, many of India’s longest-running chart-toppers are unique to the region, reflecting Netflix’s ability to deliver stories that resonate deeply with Indian audiences. By investing in culturally rich productions that blend local storytelling with global quality, Netflix is cementing its role as a driver of India’s streaming revolution — with momentum that shows no signs of slowing.

### Netflix’s Non-English Films Take Center Stage, Driving Global Growth
```{r}
non_english_total_hours <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE))

non_english_total_weeks <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  summarise(total_weeks = n_distinct(week))

top_non_english_film <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  group_by(show_title) |>
  summarise(total_number_weeks = sum(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") |>
  arrange(desc(total_number_weeks)) |>
  slice_head(n = 1)
```
Netflix is celebrating the global success of its non-English film slate, which continues to outperform expectations and drive international engagement. In the past year alone, non-English films have collectively spent more than `r non_english_total_weeks$total_weeks` weeks in the Global Top 10 and generated over `r format(non_english_total_hours$total_hours, big.mark = ",")` hours of viewership worldwide. Leading the way is *`r top_non_english_film$show_title`*, which alone has charted for `r top_non_english_film$total_number_weeks` weeks. This marks a record-breaking achievement that underscores the rising demand for diverse storytelling.

This trend highlights Netflix’s unique position as a global platform where stories from every region can find audiences everywhere. By investing in locally produced films from markets such as India, Korea, and Spain, Netflix is creating hits that not only dominate their home countries but also resonate worldwide. The continued strength of non-English films represents both a cultural shift and a business opportunity, as Netflix’s global-first approach ensures sustained growth and deeper subscriber engagement across regions. 